// JavaScript код для сайта
let пользователи = []; // массив пользователей
let статьи = []; // массив статей

// Функция для входа пользователя
function войти(event) {
    event.preventDefault();
    let почта = document.getElementById("почта").value;
    let пароль = document.getElementById("пароль").value;
    // проверяем существует ли пользователь с такой почтой и паролем
    let пользователь = пользователи.find(user => user.email === почта && user.password === пароль);
    if (пользователь) {
        // отображаем страницу с статьями
        показатьСтраницу(главнаяСтраница);
        // приветствуем пользователя
        приветствиеПользователя.textContent = `Привет, ${пользователь.name}!`;
        приветствиеПользователя.style.display = "block";
    } else {
        alert("Неправильная почта или пароль!");
    }
}

// Функция для регистрации нового пользователя
function зарегистрировать() {
    let новоеИмя = document.getElementById("новоеИмя").value;
    let новаяПочта = document.getElementById("новаяПочта").value;
    let новыйПароль = document.getElementById("новыйПароль").value;
    // проверяем, существует ли уже пользователь с такой почтой
    let существующийПользователь = пользователи.find(user => user.email === новаяПочта);
    if (существующийПользователь) {
        alert("Пользователь с такой почтой уже существует!");
    } else {
        // создаем нового пользователя и добавляем его в массив пользователей
        let новыйПользователь = {
            name: новоеИмя,
            email: новаяПочта,
            password: новыйПароль
        };
        пользователи.push(новыйПользователь);
        alert("Пользователь успешно зарегистрирован!");
        // отображаем страницу с авторизацией
        показатьСтраницу(страницаАвторизации);
    }
}

// Функция для отображения страницы
function показатьСтраницу(страница) {
    страницаАвторизации.style.display = "none";
    формаРегистрации.style.display = "none";
    главнаяСтраница.style.display = "none";
    страницаДобавленияСтатьи.style.display = "none";
    страницаПрофиля.style.display = "none";
    страница.style.display = "block";
}

// Функция для показа формы регистрации
function показатьФормуРегистрации() {
    показатьСтраницу(формаРегистрации);
}

// Функция для добавления статьи
function добавитьСтатью() {
    let названиеСтатьи = document.getElementById("названиеСтатьи").value;
    let содержаниеСтатьи = document.getElementById("содержаниеСтатьи").value;
    let тегиСтатьи = document.getElementById("тегиСтатьи").value.split(",");
    let файлДляСкачивания = document.getElementById("файлДляСкачивания").files[0];
    // создаем новую статью
    let новаяСтатья = {
        title: названиеСтатьи,
        content: содержаниеСтатьи,
        tags: тегиСтатьи,
        file: файлДляСкачивания
    };
    // добавляем статью в массив статей
    статьи.push(новаяСтатья);
    alert("Статья успешно добавлена!");
    // отображаем главную страницу
    показатьСтраницу(главнаяСтраница);
}

// Функция для перехода на страницу профиля
function перейтиКПрофилю() {
    // отображаем страницу профиля
    показатьСтраницу(страницаПрофиля);
    // выводим список пользователей и их статей
    выводитьПользователей();
}

// Функция для вывода списка пользователей и их статей
function выводитьПользователей() {
    let списокПользователей = document.getElementById("списокПользователей");
    списокПользователей.innerHTML = "";
    пользователи.forEach(user => {
        let элемент = document.createElement("div");
        элемент.textContent = `${user.name}: `;
        let сохраненныеСтатьи = статьи.filter(статья => статья.savedBy === user.email);
        сохраненныеСтатьи.forEach(статья => {
            элемент.textContent += `${статья.title}, `;
        });
        списокПользователей.appendChild(элемент);
    });
}

// Функция для выхода из профиля
function выйти() {
    // очищаем список пользователей и их статей
    let списокПользователей = document.getElementById("списокПользователей");
    списокПользователей.innerHTML = "";
    // отображаем страницу авторизации
    показатьСтраницу(страницаАвторизации);
}

// Функция для возврата на главную страницу
function вернутьсяНаГлавнуюСтраницу() {
    // отображаем главную страницу
    показатьСтраницу(главнаяСтраница);
}

// Скрипт для отображения формы добавления статьи только для администратора
let текущийПользователь; // переменная для хранения текущего пользователя

// Функция для сохранения текущего пользователя
function сохранитьТекущегоПользователя(пользователь) {
    текущийПользователь = пользователь;
}

// Функция для проверки является ли текущий пользователь администратором
function проверкаАдминистратора() {
    if (текущийПользователь && текущийПользователь.isAdmin) {
        добавитьСтатью.style.display = "block";
        перейтиКПрофилю.style.display = "block";
        выйти.style.display = "block";
    } else {
        добавитьСтатью.style.display = "none";
        перейтиКПрофилю.style.display = "none";
        выйти.style.display = "none";
    }
}

// Скрипт для проверки администратора при загрузке страницы
window.onload = function() {
    показатьСтраницу(страницаАвторизации);
    проверкаАдминистратора();
};

